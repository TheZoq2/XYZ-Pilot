NOP


SHIPPOS = 0090009000000000
SHIPVEL = 0000000000000000
SHIPACC = 0000000000000000
VECADDRIGHT = 0001000000000000
VECADDDOWN = 0000000100000000 
VECROTRIGHT = 0005000000000000

SHIPROT = 0000000000000000

START_ANGLE = 0000000000000000
TURN_SPEED = 0000000000050000

SLOW_TURN_ADD = 0002000000020000
SLOW_TURN = 0000000000000000

SHIP_SPIN = 0000000000000000
SHIP_SPIN_ADD = 0004000400000000
IS_SPINNING = 1


#Modify the model memory
ASTEROID_START = 7A
LOAD 0 ASTEROID_START
STOREOBJ 0 7

ITER:
  LOAD 0 SHIPPOS
  LOAD 1 SHIPVEL
  LOAD 3 VECADDRIGHT
  LOAD 4 VECADDDOWN
  LOAD 6 VECROTRIGHT

  LOAD 7 START_ANGLE
  LOAD 8 TURN_SPEED


  # STYR SKEPPETS HASTIGHET
  TESTLEFT:
    BTST F 5
    BEQ GOLEFT
  TESTDOWN:
    BTST F 4
    BEQ GODOWN
  TESTUP:
    BTST F 6
    BEQ GOUP
  TESTRIGHT:
    BTST F 3
    BEQ GORIGHT
  TEST_TURN_LEFT:
    BTST F 0
    BEQ TURN_LEFT
  TEST_TURN_RIGHT:
    BTST F 1
    BEQ TURN_RIGHT
  TEST_SPIN:
    BTST F 2
    BEQ DO_SPIN
  

  MOVED:


  #Update ship position and angle
  ADD 0 0 1
  STOREOBJ 0 0
  ADD 3 7 3
  STOREOBJ 3 1

  #Spin the asteroid
  LOAD 2 SLOW_TURN_ADD
  LOAD 5 SLOW_TURN

  VECADD 5 5 2
  #LSLI 5 5 1
  STOREOBJ 5 5

  STORE 0 SHIPPOS
  STORE 1 SHIPVEL
  STORE 7 START_ANGLE

  STORE 5 SLOW_TURN
  #Update the angle of the ship

  WAITFRAME
  WAITFRAME

  BRA ITER


  
#Movement 'subroutines'
GORIGHT:
  ADD 1 1 3
  BRA TEST_TURN_LEFT
GOLEFT:
  SUB 1 1 3
  BRA TESTDOWN
GODOWN:
  ADD 1 1 4
  BRA TESTUP
GOUP:
  SUB 1 1 4
  BRA TESTRIGHT
TURN_LEFT:
  SUB 7 7 8
  BRA TEST_TURN_RIGHT
TURN_RIGHT:
  ADD 7 7 8
  BRA DO_SPIN

DO_SPIN:
  IS_SPINNING = 1
  BRA MOVED
